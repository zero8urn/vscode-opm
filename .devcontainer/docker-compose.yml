services:
  opm-container:
    build:
      context: ..
      dockerfile: .devcontainer/Dockerfile
    container_name: opm-container
    volumes:
      - ..:/workspace:cached
      - node_modules:/workspace/node_modules
      - root:/root
      - $USERPROFILE/.ssh:/root/.ssh:ro
      - $USERPROFILE/.gitconfig:/root/.gitconfig:ro
      - $USERPROFILE/.local/share/opencode:/root/.local/share/opencode
    # Use the same user as the base image (devcontainer tooling will handle UID mapping)
    tty: true
    command: sleep infinity
volumes:
  node_modules:
  root:
